<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能课堂监控系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        :root {
            --primary-color: #4a6bff;
            --secondary-color: #6c5ce7;
            --success-color: #00b894;
            --warning-color: #fdcb6e;
            --danger-color: #e74c3c;
            --light-bg: #f5f7fb;
            --dark-bg: #2d3436;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --border-color: #dfe6e9;
        }

        body {
            background-color: #f0f2f5;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* 侧边栏样式 */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 25px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 25px;
        }

        .logo i {
            font-size: 28px;
            margin-right: 15px;
        }

        .logo h1 {
            font-size: 22px;
            font-weight: 600;
        }

        .nav-menu {
            flex: 1;
            padding: 0 15px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            margin-bottom: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-item:hover, .nav-item.active {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .nav-item i {
            font-size: 20px;
            margin-right: 15px;
            width: 24px;
        }

        .nav-item span {
            font-size: 16px;
            font-weight: 500;
        }

        .user-info {
            padding: 20px 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: white;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            margin-right: 15px;
        }

        .user-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .user-details p {
            font-size: 13px;
            opacity: 0.8;
        }

        /* 主要内容区域 */
        .main-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .header h2 {
            font-size: 28px;
            color: var(--text-primary);
        }

        .header-controls {
            display: flex;
            align-items: center;
        }

        .date-time {
            background-color: white;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-right: 20px;
            font-weight: 500;
        }

        .logout-btn {
            background-color: var(--danger-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background-color: #c0392b;
        }

        /* 卡片样式 */
        .card {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-title i {
            margin-right: 10px;
            color: var(--primary-color);
        }

        /* 登录页面 */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
        }

        .login-box {
            background-color: white;
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .login-header {
            text-align: center;
            margin-bottom: 35px;
        }

        .login-header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .login-header p {
            color: var(--text-secondary);
        }

        .role-selector {
            display: flex;
            margin-bottom: 25px;
            background-color: var(--light-bg);
            border-radius: 10px;
            padding: 5px;
        }

        .role-option {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .role-option.active {
            background-color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon input {
            width: 100%;
            padding: 15px 45px 15px 15px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-with-icon input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(74, 107, 255, 0.2);
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 18px;
        }

        .login-btn {
            width: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 16px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 107, 255, 0.4);
        }

        /* 监控画面样式 */
        .monitor-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }

        .video-feed {
            background-color: var(--dark-bg);
            border-radius: 10px;
            overflow: hidden;
            height: 500px;
            position: relative;
        }

        .video-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: white;
        }

        .video-placeholder i {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .analysis-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .analysis-card {
            padding: 20px;
            border-radius: 10px;
            color: white;
        }

        .analysis-card.focus {
            background: linear-gradient(135deg, var(--success-color), #00a085);
        }

        .analysis-card.emotion {
            background: linear-gradient(135deg, var(--warning-color), #f39c12);
        }

        .analysis-card.pose {
            background: linear-gradient(135deg, var(--primary-color), #3a56e4);
        }

        .analysis-value {
            font-size: 36px;
            font-weight: 700;
            margin: 10px 0;
        }

        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .student-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .student-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: var(--light-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 24px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .focus-indicator {
            height: 6px;
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .focus-level {
            height: 100%;
            border-radius: 3px;
        }

        .focus-high {
            background-color: var(--success-color);
            width: 85%;
        }

        .focus-medium {
            background-color: var(--warning-color);
            width: 60%;
        }

        .focus-low {
            background-color: var(--danger-color);
            width: 35%;
        }

        /* 表格样式 */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background-color: var(--light-bg);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        tr:hover {
            background-color: rgba(74, 107, 255, 0.05);
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            margin-right: 8px;
        }

        .action-btn.edit {
            background-color: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .action-btn.delete {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }

        .action-btn.reset {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--success-color);
        }

        .action-btn.view {
            background-color: rgba(155, 89, 182, 0.1);
            color: #8e44ad;
        }

        .action-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* 空状态样式 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        /* 文件上传样式 */
        .file-upload-area {
            border: 3px dashed var(--border-color);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .file-upload-area:hover {
            border-color: var(--primary-color);
            background-color: rgba(74, 107, 255, 0.05);
        }

        .file-upload-area i {
            font-size: 60px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        /* 响应式设计 */
        @media (max-width: 1200px) {
            .monitor-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 15px 0;
            }
            
            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 10px;
            }
            
            .nav-item {
                flex-shrink: 0;
                margin-bottom: 0;
                margin-right: 10px;
            }
            
            .user-info {
                display: none;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .header-controls {
                margin-top: 15px;
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- 登录页面 -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1><i class="fas fa-graduation-cap"></i> 智能课堂监控系统</h1>
                <p>教师端 & 管理员端登录</p>
            </div>
            
            <div class="role-selector">
                <div class="role-option active" data-role="teacher">教师端</div>
                <div class="role-option" data-role="admin">管理员端</div>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">账号</label>
                    <div class="input-with-icon">
                        <input type="text" id="username" placeholder="请输入账号" required>
                        <i class="fas fa-user" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #aaa;"></i>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="password">密码</label>
                    <div class="input-with-icon">
                        <input type="password" id="password" placeholder="请输入密码" required>
                        <i class="fas fa-lock" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #aaa;"></i>
                        <button type="button" class="password-toggle" id="togglePassword">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <button type="submit" class="login-btn">登录系统</button>
            </form>
            
            <div style="margin-top: 25px; text-align: center; color: var(--text-secondary); font-size: 14px;">
                <p>提示：首次使用请使用管理员账号创建教师账号</p>
            </div>
        </div>
    </div>
    
    <!-- 教师端主界面 -->
    <div id="teacherPage" class="container" style="display: none;">
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <h1>课堂监控系统</h1>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>监控仪表盘</span>
                </div>
                <div class="nav-item" data-page="reports">
                    <i class="fas fa-chart-bar"></i>
                    <span>历史报告</span>
                </div>
                <div class="nav-item" data-page="students">
                    <i class="fas fa-users"></i>
                    <span>学生管理</span>
                </div>
                <div class="nav-item" data-page="import">
                    <i class="fas fa-file-import"></i>
                    <span>导入学生</span>
                </div>
                <div class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span>个人设置</span>
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="teacherAvatar">?</div>
                <div class="user-details">
                    <h4 id="teacherName">未设置</h4>
                    <p id="teacherInfo">请完善个人信息</p>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h2 id="pageTitle">监控仪表盘</h2>
                <div class="header-controls">
                    <div class="date-time" id="currentDateTime">2023年10月15日 14:30:45</div>
                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> 退出登录
                    </button>
                </div>
            </div>
            
            <!-- 监控仪表盘页面 -->
            <div id="dashboardPage" class="page-content">
                <div class="monitor-container">
                    <div class="card video-feed">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-video"></i> 课堂实时监控
                            </div>
                            <div style="color: white; background-color: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px;">
                                <i class="fas fa-circle" style="color: #00b894; font-size: 12px; margin-right: 5px;"></i> 等待连接
                            </div>
                        </div>
                        <div class="video-placeholder">
                            <i class="fas fa-video"></i>
                            <p>实时视频流 (等待后端连接)</p>
                            <p style="font-size: 14px; margin-top: 10px; opacity: 0.7;">人脸识别、表情分析、头部姿态检测运行中...</p>
                        </div>
                    </div>
                    
                    <div class="analysis-panel">
                        <div class="card analysis-card focus">
                            <h3><i class="fas fa-brain"></i> 整体专注度</h3>
                            <div class="analysis-value" id="overallFocus">--%</div>
                            <p id="focusTrend">暂无数据</p>
                        </div>
                        
                        <div class="card analysis-card emotion">
                            <h3><i class="fas fa-smile"></i> 课堂情绪分析</h3>
                            <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>积极情绪</p>
                                </div>
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>中性情绪</p>
                                </div>
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>消极情绪</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card analysis-card pose">
                            <h3><i class="fas fa-user-headset"></i> 头部姿态分析</h3>
                            <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>正视前方</p>
                                </div>
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>轻微分心</p>
                                </div>
                                <div>
                                    <div class="analysis-value" style="font-size: 24px;">--%</div>
                                    <p>明显分心</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-user-graduate"></i> 学生专注度详情
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary);" id="studentCountInfo">
                            当前班级：未设置 | 学生人数：0
                        </div>
                    </div>
                    <div class="student-grid" id="studentFocusGrid">
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <h3>暂无学生数据</h3>
                            <p>请先导入学生信息或添加学生</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 历史报告页面 -->
            <div id="reportsPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-line"></i> 课堂专注度历史报告
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <select id="reportPeriod" style="padding: 8px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                                <option>最近一周</option>
                                <option>最近一个月</option>
                                <option>最近三个月</option>
                            </select>
                            <button class="action-btn edit" id="exportReportBtn">
                                <i class="fas fa-download"></i> 导出报告
                            </button>
                        </div>
                    </div>
                    
                    <div style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);" id="reportChartContainer">
                        <div class="empty-state">
                            <i class="fas fa-chart-line"></i>
                            <p>暂无历史报告数据</p>
                            <p style="font-size: 14px; margin-top: 10px;">监控系统运行后将自动生成报告</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-history"></i> 历史课堂记录
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="historyTable">
                            <thead>
                                <tr>
                                    <th>日期</th>
                                    <th>课程名称</th>
                                    <th>平均专注度</th>
                                    <th>情绪分析</th>
                                    <th>头部姿态</th>
                                    <th>报告</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px;">
                                        <div class="empty-state" style="padding: 0;">
                                            <i class="fas fa-history"></i>
                                            <p>暂无历史课堂记录</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- 学生管理页面 -->
            <div id="studentsPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-users"></i> 学生列表
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="studentSearch" placeholder="搜索学生..." style="padding: 8px 15px; border-radius: 8px; border: 1px solid var(--border-color); width: 200px;">
                            <button class="action-btn edit" id="addStudentBtn">
                                <i class="fas fa-plus"></i> 添加学生
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="studentsTable">
                            <thead>
                                <tr>
                                    <th>学号</th>
                                    <th>姓名</th>
                                    <th>性别</th>
                                    <th>班级</th>
                                    <th>录入时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px;">
                                        <div class="empty-state" style="padding: 0;">
                                            <i class="fas fa-users"></i>
                                            <p>暂无学生数据</p>
                                            <p style="font-size: 14px; margin-top: 10px;">请先导入学生信息或添加学生</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- 导入学生页面 -->
            <div id="importPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-file-import"></i> 导入学生信息
                        </div>
                    </div>
                    
                    <div style="padding: 30px 20px;">
                        <div class="file-upload-area" id="fileUploadArea">
                            <i class="fas fa-file-excel"></i>
                            <h3>点击上传Excel文件</h3>
                            <p>支持.xlsx和.csv格式</p>
                            <input type="file" id="studentFileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                        </div>
                        
                        <div id="uploadPreview" style="display: none; margin-top: 20px;">
                            <h3 style="margin-bottom: 15px;">上传预览</h3>
                            <div class="table-container">
                                <table id="previewTable">
                                    <thead>
                                        <tr>
                                            <th>学号</th>
                                            <th>姓名</th>
                                            <th>性别</th>
                                            <th>班级</th>
                                        </tr>
                                    </thead>
                                    <tbody id="previewTableBody">
                                        <!-- 预览数据将通过JS动态生成 -->
                                    </tbody>
                                </table>
                            </div>
                            <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 20px;">
                                <button class="action-btn delete" id="cancelImportBtn">取消</button>
                                <button class="login-btn" id="confirmImportBtn" style="width: auto; padding: 12px 30px;">确认导入</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; text-align: left; background-color: var(--light-bg); padding: 20px; border-radius: 10px;">
                            <h3 style="margin-bottom: 15px;"><i class="fas fa-info-circle"></i> 导入说明</h3>
                            <ul style="padding-left: 20px;">
                                <li>请确保Excel文件格式正确，第一行应为标题行</li>
                                <li>必填字段：学号、姓名、性别、班级</li>
                                <li>一次最多导入200名学生信息</li>
                                <li>系统将自动检测重复学号并提示</li>
                                <li><button class="action-btn edit" id="downloadTemplateBtn" style="margin-top: 10px;"><i class="fas fa-download"></i> 下载模板文件</button></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 个人设置页面 -->
            <div id="settingsPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-user-cog"></i> 个人设置
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 30px; margin-top: 20px;">
                        <div style="text-align: center;">
                            <div class="user-avatar" id="settingsAvatar" style="width: 150px; height: 150px; font-size: 50px; margin: 0 auto 20px;">?</div>
                            <button class="action-btn edit" id="changeAvatarBtn" style="width: 100%;">
                                <i class="fas fa-camera"></i> 更换头像
                            </button>
                        </div>
                        
                        <div>
                            <div class="form-group">
                                <label>姓名</label>
                                <input type="text" id="teacherFullName" value="未设置" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                            </div>
                            
                            <div class="form-group">
                                <label>所属班级</label>
                                <select id="teacherClass" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                                    <option value="">请选择班级</option>
                                    <option>高三(1)班</option>
                                    <option>高三(2)班</option>
                                    <option>高三(3)班</option>
                                    <option>高二(1)班</option>
                                    <option>高二(2)班</option>
                                    <option>高一(1)班</option>
                                    <option>高一(2)班</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>所教科目</label>
                                <select id="teacherSubject" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                                    <option value="">请选择科目</option>
                                    <option>语文</option>
                                    <option>数学</option>
                                    <option>英语</option>
                                    <option>物理</option>
                                    <option>化学</option>
                                    <option>生物</option>
                                    <option>历史</option>
                                    <option>地理</option>
                                    <option>政治</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>邮箱</label>
                                <input type="email" id="teacherEmail" placeholder="请输入邮箱" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                            </div>
                            
                            <div class="form-group">
                                <label>手机号码</label>
                                <input type="tel" id="teacherPhone" placeholder="请输入手机号码" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                            </div>
                            
                            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                                <h3 style="margin-bottom: 15px;">修改密码</h3>
                                <div class="form-group">
                                    <label>当前密码</label>
                                    <div class="input-with-icon">
                                        <input type="password" id="currentPassword" placeholder="请输入当前密码">
                                        <button type="button" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>新密码</label>
                                    <div class="input-with-icon">
                                        <input type="password" id="newPassword" placeholder="请输入新密码">
                                        <button type="button" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>确认新密码</label>
                                    <div class="input-with-icon">
                                        <input type="password" id="confirmPassword" placeholder="请再次输入新密码">
                                        <button type="button" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="login-btn" id="saveTeacherSettingsBtn" style="width: auto; padding: 12px 30px; margin-top: 20px;">
                                <i class="fas fa-save"></i> 保存更改
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 管理员端主界面 -->
    <div id="adminPage" class="container" style="display: none;">
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-user-shield"></i>
                <h1>系统管理端</h1>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-page="adminDashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>班级监控</span>
                </div>
                <div class="nav-item" data-page="teacherManagement">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>教师管理</span>
                </div>
                <div class="nav-item" data-page="systemSettings">
                    <i class="fas fa-cog"></i>
                    <span>系统设置</span>
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">管</div>
                <div class="user-details">
                    <h4>系统管理员</h4>
                    <p>最高权限</p>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h2 id="adminPageTitle">班级实时状态</h2>
                <div class="header-controls">
                    <div class="date-time" id="adminCurrentDateTime">2023年10月15日 14:30:45</div>
                    <button class="logout-btn" id="adminLogoutBtn">
                        <i class="fas fa-sign-out-alt"></i> 退出登录
                    </button>
                </div>
            </div>
            
            <!-- 班级监控页面 -->
            <div id="adminDashboardPage" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-school"></i> 班级实时状态
                        </div>
                        <select id="classFilter" style="padding: 8px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                            <option value="all">全部班级</option>
                            <option value="grade3">高三年级</option>
                            <option value="grade2">高二年级</option>
                            <option value="grade1">高一年级</option>
                        </select>
                    </div>
                    
                    <div class="student-grid" id="classStatusGrid">
                        <div class="empty-state">
                            <i class="fas fa-school"></i>
                            <h3>暂无班级监控数据</h3>
                            <p>教师端开启监控后，班级状态将显示在这里</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i> 全校专注度统计
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary);" id="statsUpdateTime">
                            暂无数据
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;" id="schoolStatsContainer">
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <i class="fas fa-chart-pie"></i>
                            <p>暂无全校统计数据</p>
                            <p style="font-size: 14px; margin-top: 10px;">等待教师端监控数据上传</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 教师管理页面 -->
            <div id="teacherManagementPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chalkboard-teacher"></i> 教师账户管理
                        </div>
                        <button class="action-btn edit" id="addTeacherBtn">
                            <i class="fas fa-plus"></i> 添加教师
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table id="teachersTable">
                            <thead>
                                <tr>
                                    <th>工号</th>
                                    <th>姓名</th>
                                    <th>学科</th>
                                    <th>负责班级</th>
                                    <th>账号状态</th>
                                    <th>创建时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="teachersTableBody">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">
                                        <div class="empty-state" style="padding: 0;">
                                            <i class="fas fa-chalkboard-teacher"></i>
                                            <p>暂无教师账户</p>
                                            <p style="font-size: 14px; margin-top: 10px;">请点击"添加教师"创建教师账户</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- 系统设置页面 -->
            <div id="systemSettingsPage" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-sliders-h"></i> 系统参数设置
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 20px;">
                        <div>
                            <h3 style="margin-bottom: 15px;"><i class="fas fa-video"></i> 监控设置</h3>
                            <div class="form-group">
                                <label>专注度阈值</label>
                                <input type="range" id="focusThreshold" min="0" max="100" value="60" style="width: 100%;">
                                <div style="display: flex; justify-content: space-between; font-size: 14px; color: var(--text-secondary);">
                                    <span>低敏感度</span>
                                    <span id="focusThresholdValue">60%</span>
                                    <span>高敏感度</span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>数据采集频率</label>
                                <select id="dataCollectionFrequency" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                                    <option value="5">每5秒</option>
                                    <option value="10" selected>每10秒</option>
                                    <option value="30">每30秒</option>
                                    <option value="60">每1分钟</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <h3 style="margin-bottom: 15px;"><i class="fas fa-bell"></i> 通知设置</h3>
                            <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                                <label>专注度过低提醒</label>
                                <label class="switch">
                                    <input type="checkbox" id="lowFocusAlert" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                                <label>异常行为警报</label>
                                <label class="switch">
                                    <input type="checkbox" id="abnormalBehaviorAlert" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                                <label>每日报告推送</label>
                                <label class="switch">
                                    <input type="checkbox" id="dailyReportAlert">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                        <h3 style="margin-bottom: 15px;"><i class="fas fa-database"></i> 数据管理</h3>
                        <div style="display: flex; gap: 15px;">
                            <button class="action-btn edit" id="exportAllDataBtn">
                                <i class="fas fa-download"></i> 导出所有数据
                            </button>
                            <button class="action-btn delete" id="clearHistoryDataBtn">
                                <i class="fas fa-trash-alt"></i> 清空历史数据
                            </button>
                            <button class="action-btn reset" id="rebuildIndexBtn">
                                <i class="fas fa-sync-alt"></i> 重建数据库索引
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color); text-align: center;">
                        <button class="login-btn" id="saveSystemSettingsBtn" style="width: auto; padding: 12px 30px;">
                            <i class="fas fa-save"></i> 保存系统设置
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加学生模态框 -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">添加学生</div>
                <button class="modal-close" id="closeAddStudentModal">&times;</button>
            </div>
            <form id="addStudentForm">
                <div class="form-group">
                    <label>学号 *</label>
                    <input type="text" id="studentId" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>姓名 *</label>
                    <input type="text" id="studentName" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>性别 *</label>
                    <select id="studentGender" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <option value="">请选择性别</option>
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>班级 *</label>
                    <select id="studentClass" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <option value="">请选择班级</option>
                        <option>高三(1)班</option>
                        <option>高三(2)班</option>
                        <option>高三(3)班</option>
                        <option>高二(1)班</option>
                        <option>高二(2)班</option>
                        <option>高一(1)班</option>
                        <option>高一(2)班</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>联系电话</label>
                    <input type="tel" id="studentPhone" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>家长姓名</label>
                    <input type="text" id="parentName" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>家长电话</label>
                    <input type="tel" id="parentPhone" style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <button type="submit" class="login-btn" style="width: 100%; margin-top: 20px;">添加学生</button>
            </form>
        </div>
    </div>

    <!-- 添加教师模态框 -->
    <div id="addTeacherModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">添加教师账户</div>
                <button class="modal-close" id="closeAddTeacherModal">&times;</button>
            </div>
            <form id="addTeacherForm">
                <div class="form-group">
                    <label>工号 *</label>
                    <input type="text" id="teacherId" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>姓名 *</label>
                    <input type="text" id="newTeacherName" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>登录账号 *</label>
                    <input type="text" id="teacherUsername" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                </div>
                
                <div class="form-group">
                    <label>初始密码 *</label>
                    <div class="input-with-icon">
                        <input type="password" id="teacherPassword" required placeholder="设置初始密码">
                        <button type="button" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>确认密码 *</label>
                    <div class="input-with-icon">
                        <input type="password" id="confirmTeacherPassword" required placeholder="确认初始密码">
                        <button type="button" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>所教科目 *</label>
                    <select id="newTeacherSubject" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <option value="">请选择科目</option>
                        <option>语文</option>
                        <option>数学</option>
                        <option>英语</option>
                        <option>物理</option>
                        <option>化学</option>
                        <option>生物</option>
                        <option>历史</option>
                        <option>地理</option>
                        <option>政治</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>负责班级 *</label>
                    <select id="newTeacherClass" required style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <option value="">请选择班级</option>
                        <option>高三(1)班</option>
                        <option>高三(2)班</option>
                        <option>高三(3)班</option>
                        <option>高二(1)班</option>
                        <option>高二(2)班</option>
                        <option>高一(1)班</option>
                        <option>高一(2)班</option>
                    </select>
                </div>
                
                <button type="submit" class="login-btn" style="width: 100%; margin-top: 20px;">创建教师账户</button>
            </form>
        </div>
    </div>

    <!-- 更改密码模态框 -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">更改教师密码</div>
                <button class="modal-close" id="closeChangePasswordModal">&times;</button>
            </div>
            <form id="changePasswordForm">
                <input type="hidden" id="selectedTeacherId">
                <div class="form-group">
                    <label>教师姓名</label>
                    <input type="text" id="selectedTeacherName" readonly style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color); background-color: var(--light-bg);">
                </div>
                
                <div class="form-group">
                    <label>新密码 *</label>
                    <div class="input-with-icon">
                        <input type="password" id="newTeacherPassword" required placeholder="输入新密码">
                        <button type="button" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>确认新密码 *</label>
                    <div class="input-with-icon">
                        <input type="password" id="confirmNewTeacherPassword" required placeholder="确认新密码">
                        <button type="button" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <button type="submit" class="login-btn" style="width: 100%; margin-top: 20px;">更改密码</button>
            </form>
        </div>
    </div>

    <script>
        // 全局数据存储
        const appData = {
            students: [], // 学生列表
            teachers: [], // 教师列表
            currentTeacher: null, // 当前登录教师
            systemSettings: { // 系统设置
                focusThreshold: 60,
                dataCollectionFrequency: 10,
                lowFocusAlert: true,
                abnormalBehaviorAlert: true,
                dailyReportAlert: false
            },
            // 模拟一些班级状态数据
            classStatus: [],
            // 模拟历史报告数据
            historyReports: []
        };

        // 模拟数据初始化（在实际系统中这些数据应该来自后端API）
        function initializeMockData() {
            // 如果没有本地存储的数据，初始化一些示例数据
            if (!localStorage.getItem('classMonitorSystem')) {
                // 初始管理员账号
                appData.teachers = [
                    {
                        id: 'T001',
                        username: 'admin',
                        password: 'admin123',
                        name: '系统管理员',
                        subject: '系统管理',
                        class: '全校',
                        email: 'admin@school.com',
                        phone: '13800138000',
                        status: '正常',
                        createTime: '2023-10-01',
                        role: 'admin'
                    }
                ];
                
                // 保存到本地存储
                saveDataToLocalStorage();
            } else {
                // 从本地存储加载数据
                loadDataFromLocalStorage();
            }
        }

        // 保存数据到本地存储
        function saveDataToLocalStorage() {
            const data = {
                students: appData.students,
                teachers: appData.teachers,
                systemSettings: appData.systemSettings,
                historyReports: appData.historyReports
            };
            localStorage.setItem('classMonitorSystem', JSON.stringify(data));
        }

        // 从本地存储加载数据
        function loadDataFromLocalStorage() {
            const data = JSON.parse(localStorage.getItem('classMonitorSystem'));
            if (data) {
                appData.students = data.students || [];
                appData.teachers = data.teachers || [];
                appData.systemSettings = data.systemSettings || appData.systemSettings;
                appData.historyReports = data.historyReports || [];
            }
        }

        // 更新班级状态数据
        function updateClassStatus() {
            // 在实际系统中，这里应该从后端API获取实时数据
            // 这里我们模拟生成一些班级状态数据
            appData.classStatus = [];
            
            // 获取所有有教师的班级
            const teacherClasses = [...new Set(appData.teachers
                .filter(t => t.role !== 'admin' && t.class)
                .map(t => t.class))];
            
            teacherClasses.forEach(className => {
                // 查找负责该班级的教师
                const teacher = appData.teachers.find(t => t.class === className);
                if (teacher) {
                    // 查找该班级的学生
                    const classStudents = appData.students.filter(s => s.class === className);
                    
                    // 模拟专注度数据
                    const avgFocus = classStudents.length > 0 ? 
                        Math.round(classStudents.reduce((sum, s) => sum + (s.focus || 0), 0) / classStudents.length) : 0;
                    
                    appData.classStatus.push({
                        className: className,
                        teacherName: teacher.name,
                        subject: teacher.subject,
                        studentCount: classStudents.length,
                        avgFocus: avgFocus,
                        attendance: classStudents.length > 0 ? Math.round(Math.random() * 20 + 80) : 0, // 模拟出勤率
                        status: 'active' // 模拟状态
                    });
                }
            });
        }

        // 更新全校统计数据
        function updateSchoolStats() {
            // 这里应该从后端API获取统计数据
            // 模拟生成统计数据
            const statsContainer = document.getElementById('schoolStatsContainer');
            if (!statsContainer) return;
            
            const grade3Focus = Math.round(Math.random() * 15 + 70);
            const grade2Focus = Math.round(Math.random() * 15 + 65);
            const grade1Focus = Math.round(Math.random() * 15 + 60);
            const overallFocus = Math.round((grade3Focus + grade2Focus + grade1Focus) / 3);
            
            statsContainer.innerHTML = `
                <div style="background: linear-gradient(135deg, #4a6bff, #6c5ce7); color: white; padding: 20px; border-radius: 10px;">
                    <h3>高三年级</h3>
                    <div class="analysis-value" style="font-size: 32px;">${grade3Focus}%</div>
                    <p>平均专注度</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #00b894, #00a085); color: white; padding: 20px; border-radius: 10px;">
                    <h3>高二年级</h3>
                    <div class="analysis-value" style="font-size: 32px;">${grade2Focus}%</div>
                    <p>平均专注度</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #fdcb6e, #f39c12); color: white; padding: 20px; border-radius: 10px;">
                    <h3>高一年级</h3>
                    <div class="analysis-value" style="font-size: 32px;">${grade1Focus}%</div>
                    <p>平均专注度</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #a29bfe, #6c5ce7); color: white; padding: 20px; border-radius: 10px;">
                    <h3>全校平均</h3>
                    <div class="analysis-value" style="font-size: 32px;">${overallFocus}%</div>
                    <p>综合专注度</p>
                </div>
            `;
            
            // 更新时间显示
            const now = new Date();
            const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            document.getElementById('statsUpdateTime').textContent = `数据更新于 ${timeStr}`;
        }

        // 更新班级状态显示
        function updateClassStatusDisplay() {
            const classStatusGrid = document.getElementById('classStatusGrid');
            if (!classStatusGrid) return;
            
            if (appData.classStatus.length === 0) {
                classStatusGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-school"></i>
                        <h3>暂无班级监控数据</h3>
                        <p>教师端开启监控后，班级状态将显示在这里</p>
                    </div>
                `;
                return;
            }
            
            classStatusGrid.innerHTML = appData.classStatus.map(status => `
                <div class="student-card" style="text-align: left; padding: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div class="student-avatar" style="width: 50px; height: 50px; margin: 0 15px 0 0; background-color: rgba(74, 107, 255, 0.1);">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div>
                            <h4>${status.className}</h4>
                            <p style="font-size: 14px; color: var(--text-secondary);">${status.teacherName} | ${status.subject}</p>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                        <div>
                            <div style="font-size: 24px; font-weight: 700; color: ${status.avgFocus >= 80 ? 'var(--success-color)' : status.avgFocus >= 60 ? 'var(--warning-color)' : 'var(--danger-color)'};">${status.avgFocus}%</div>
                            <p style="font-size: 13px; color: var(--text-secondary);">专注度</p>
                        </div>
                        <div>
                            <div style="font-size: 24px; font-weight: 700; color: var(--primary-color);">${status.studentCount}</div>
                            <p style="font-size: 13px; color: var(--text-secondary);">学生数</p>
                        </div>
                        <div>
                            <div style="font-size: 24px; font-weight: 700; color: #00b894;">${status.attendance}%</div>
                            <p style="font-size: 13px; color: var(--text-secondary);">出勤率</p>
                        </div>
                    </div>
                    <button class="action-btn view" style="width: 100%; margin-top: 15px;" onclick="viewClassDetails('${status.className}')">
                        <i class="fas fa-external-link-alt"></i> 查看详情
                    </button>
                </div>
            `).join('');
        }

        // 查看班级详情
        function viewClassDetails(className) {
            alert(`查看 ${className} 的详细监控数据\n\n在实际系统中，这里会跳转到班级详情页面，显示该班级的实时监控数据、学生专注度详情等信息。`);
        }

        // 更新学生显示
        function updateStudentsDisplay() {
            const studentFocusGrid = document.getElementById('studentFocusGrid');
            const studentsTableBody = document.getElementById('studentsTableBody');
            
            if (!studentFocusGrid || !studentsTableBody) return;
            
            const teacherClass = appData.currentTeacher ? appData.currentTeacher.class : '';
            const classStudents = appData.students.filter(student => 
                teacherClass ? student.class === teacherClass : true
            );
            
            // 更新学生人数信息
            document.getElementById('studentCountInfo').textContent = 
                `当前班级：${teacherClass || '未设置'} | 学生人数：${classStudents.length}`;
            
            // 更新学生专注度网格
            if (classStudents.length === 0) {
                studentFocusGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>暂无学生数据</h3>
                        <p>请先导入学生信息或添加学生</p>
                    </div>
                `;
            } else {
                studentFocusGrid.innerHTML = classStudents.map(student => {
                    const focus = student.focus || Math.round(Math.random() * 40 + 60); // 模拟专注度
                    let focusClass = 'focus-high';
                    if (focus < 70) focusClass = 'focus-low';
                    else if (focus < 85) focusClass = 'focus-medium';
                    
                    return `
                        <div class="student-card">
                            <div class="student-avatar">${student.name.charAt(0)}</div>
                            <h4>${student.name}</h4>
                            <p style="color: var(--text-secondary); font-size: 14px;">学号: ${student.id}</p>
                            <div style="margin-top: 10px; font-weight: 600; font-size: 18px;">${focus}%</div>
                            <div class="focus-indicator">
                                <div class="focus-level ${focusClass}"></div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            // 更新学生表格
            if (classStudents.length === 0) {
                studentsTableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px;">
                            <div class="empty-state" style="padding: 0;">
                                <i class="fas fa-users"></i>
                                <p>暂无学生数据</p>
                                <p style="font-size: 14px; margin-top: 10px;">请先导入学生信息或添加学生</p>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                studentsTableBody.innerHTML = classStudents.map(student => {
                    const focus = student.focus || Math.round(Math.random() * 40 + 60);
                    return `
                        <tr>
                            <td>${student.id}</td>
                            <td>${student.name}</td>
                            <td>${student.gender}</td>
                            <td>${student.class}</td>
                            <td>${student.createTime || '2023-10-15'}</td>
                            <td>
                                <button class="action-btn edit" onclick="editStudent('${student.id}')">编辑</button>
                                <button class="action-btn delete" onclick="deleteStudent('${student.id}')">删除</button>
                            </td>
                        </tr>
                    `;
                }).join('');
            }
            
            // 更新整体专注度（模拟）
            if (classStudents.length > 0) {
                const avgFocus = Math.round(classStudents.reduce((sum, student) => 
                    sum + (student.focus || Math.round(Math.random() * 40 + 60)), 0) / classStudents.length);
                document.getElementById('overallFocus').textContent = `${avgFocus}%`;
                document.getElementById('focusTrend').textContent = '数据更新中...';
                
                // 模拟情绪分析和头部姿态数据
                document.querySelectorAll('.analysis-card.emotion .analysis-value').forEach((el, i) => {
                    const values = [62, 25, 13];
                    el.textContent = `${values[i]}%`;
                });
                
                document.querySelectorAll('.analysis-card.pose .analysis-value').forEach((el, i) => {
                    const values = [85, 12, 3];
                    el.textContent = `${values[i]}%`;
                });
            }
        }

        // 更新教师显示
        function updateTeachersDisplay() {
            const teachersTableBody = document.getElementById('teachersTableBody');
            if (!teachersTableBody) return;
            
            const teacherList = appData.teachers.filter(t => t.role !== 'admin');
            
            if (teacherList.length === 0) {
                teachersTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <div class="empty-state" style="padding: 0;">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <p>暂无教师账户</p>
                                <p style="font-size: 14px; margin-top: 10px;">请点击"添加教师"创建教师账户</p>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                teachersTableBody.innerHTML = teacherList.map(teacher => `
                    <tr>
                        <td>${teacher.id}</td>
                        <td>${teacher.name}</td>
                        <td>${teacher.subject}</td>
                        <td>${teacher.class}</td>
                        <td>
                            <span style="padding: 4px 10px; border-radius: 20px; font-size: 13px; background-color: ${teacher.status === '正常' ? 'rgba(46, 204, 113, 0.1)' : 'rgba(231, 76, 60, 0.1)'}; color: ${teacher.status === '正常' ? '#27ae60' : '#c0392b'};">${teacher.status || '正常'}</span>
                        </td>
                        <td>${teacher.createTime || '2023-10-15'}</td>
                        <td>
                            <button class="action-btn edit" title="更改密码" onclick="openChangePasswordModal('${teacher.id}', '${teacher.name}')"><i class="fas fa-key"></i></button>
                            <button class="action-btn delete" title="删除账号" onclick="deleteTeacher('${teacher.id}')"><i class="fas fa-trash-alt"></i></button>
                            <button class="action-btn reset" title="重置密码" onclick="resetTeacherPassword('${teacher.id}')"><i class="fas fa-redo"></i></button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        // 编辑学生
        function editStudent(studentId) {
            const student = appData.students.find(s => s.id === studentId);
            if (student) {
                alert(`编辑学生: ${student.name}\n\n在实际系统中，这里会打开编辑模态框，允许修改学生信息。`);
            }
        }

        // 删除学生
        function deleteStudent(studentId) {
            if (confirm('确定要删除这个学生吗？此操作不可撤销。')) {
                appData.students = appData.students.filter(s => s.id !== studentId);
                saveDataToLocalStorage();
                updateStudentsDisplay();
                updateClassStatus();
                updateClassStatusDisplay();
                alert('学生删除成功！');
            }
        }

        // 添加学生
        function addStudent(studentData) {
            // 检查学号是否已存在
            if (appData.students.some(s => s.id === studentData.id)) {
                alert('该学号已存在，请使用不同的学号！');
                return false;
            }
            
            // 设置创建时间
            studentData.createTime = new Date().toISOString().split('T')[0];
            
            // 添加到学生列表
            appData.students.push(studentData);
            saveDataToLocalStorage();
            
            // 更新显示
            updateStudentsDisplay();
            updateClassStatus();
            updateClassStatusDisplay();
            
            return true;
        }

        // 添加教师
        function addTeacher(teacherData) {
            // 检查工号是否已存在
            if (appData.teachers.some(t => t.id === teacherData.id)) {
                alert('该工号已存在，请使用不同的工号！');
                return false;
            }
            
            // 检查用户名是否已存在
            if (appData.teachers.some(t => t.username === teacherData.username)) {
                alert('该用户名已存在，请使用不同的用户名！');
                return false;
            }
            
            // 设置创建时间和默认状态
            teacherData.createTime = new Date().toISOString().split('T')[0];
            teacherData.status = '正常';
            teacherData.role = 'teacher';
            
            // 添加到教师列表
            appData.teachers.push(teacherData);
            saveDataToLocalStorage();
            
            // 更新显示
            updateTeachersDisplay();
            updateClassStatus();
            updateClassStatusDisplay();
            
            return true;
        }

        // 删除教师
        function deleteTeacher(teacherId) {
            if (confirm('确定要删除这个教师账户吗？此操作不可撤销。')) {
                appData.teachers = appData.teachers.filter(t => t.id !== teacherId);
                saveDataToLocalStorage();
                updateTeachersDisplay();
                updateClassStatus();
                updateClassStatusDisplay();
                alert('教师账户删除成功！');
            }
        }

        // 打开更改密码模态框
        function openChangePasswordModal(teacherId, teacherName) {
            document.getElementById('selectedTeacherId').value = teacherId;
            document.getElementById('selectedTeacherName').value = teacherName;
            document.getElementById('changePasswordModal').style.display = 'flex';
        }

        // 重置教师密码
        function resetTeacherPassword(teacherId) {
            if (confirm('确定要重置该教师的密码吗？重置后密码将恢复为初始密码。')) {
                const teacher = appData.teachers.find(t => t.id === teacherId);
                if (teacher) {
                    teacher.password = '123456'; // 重置为默认密码
                    saveDataToLocalStorage();
                    alert(`教师 ${teacher.name} 的密码已重置为：123456`);
                }
            }
        }

        // 更新教师个人信息显示
        function updateTeacherInfoDisplay() {
            if (appData.currentTeacher) {
                const teacher = appData.currentTeacher;
                
                // 更新侧边栏信息
                document.getElementById('teacherAvatar').textContent = teacher.name.charAt(0);
                document.getElementById('teacherName').textContent = teacher.name || '未设置';
                document.getElementById('teacherInfo').textContent = 
                    `${teacher.subject || '未设置科目'} | ${teacher.class || '未设置班级'}`;
                
                // 更新设置页面表单
                document.getElementById('teacherFullName').value = teacher.name || '';
                document.getElementById('teacherClass').value = teacher.class || '';
                document.getElementById('teacherSubject').value = teacher.subject || '';
                document.getElementById('teacherEmail').value = teacher.email || '';
                document.getElementById('teacherPhone').value = teacher.phone || '';
                document.getElementById('settingsAvatar').textContent = teacher.name.charAt(0);
            }
        }

        // 模拟Excel文件导入
        function simulateExcelImport() {
            // 模拟Excel数据
            const mockData = [
                { id: 'S001', name: '李明', gender: '男', class: '高三(1)班' },
                { id: 'S002', name: '王芳', gender: '女', class: '高三(1)班' },
                { id: 'S003', name: '张伟', gender: '男', class: '高三(1)班' },
                { id: 'S004', name: '刘洋', gender: '男', class: '高三(1)班' },
                { id: 'S005', name: '陈静', gender: '女', class: '高三(1)班' }
            ];
            
            return mockData;
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化模拟数据
            initializeMockData();
            
            // 登录页面功能
            const togglePasswordBtn = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('password');
            const roleOptions = document.querySelectorAll('.role-option');
            const loginForm = document.getElementById('loginForm');
            
            // 密码显示/隐藏切换
            togglePasswordBtn.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            });
            
            // 角色选择
            roleOptions.forEach(option => {
                option.addEventListener('click', function() {
                    roleOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // 登录表单提交
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const selectedRole = document.querySelector('.role-option.active').getAttribute('data-role');
                
                // 查找用户
                const user = appData.teachers.find(t => t.username === username && t.password === password);
                
                if (user) {
                    if (selectedRole === 'teacher' && user.role === 'teacher') {
                        appData.currentTeacher = user;
                        showTeacherPage();
                    } else if (selectedRole === 'admin' && user.role === 'admin') {
                        showAdminPage();
                    } else {
                        alert(`登录失败：请使用${selectedRole === 'teacher' ? '教师' : '管理员'}账号登录`);
                    }
                } else {
                    alert('账号或密码错误！');
                }
            });
            
            // 更新日期时间
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // 绑定教师端导航菜单点击事件
            document.querySelectorAll('#teacherPage .nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const page = this.getAttribute('data-page');
                    showTeacherPageContent(page);
                });
            });
            
            // 绑定管理员端导航菜单点击事件
            document.querySelectorAll('#adminPage .nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const page = this.getAttribute('data-page');
                    showAdminPageContent(page);
                });
            });
            
            // 绑定退出登录按钮
            document.getElementById('logoutBtn').addEventListener('click', showLoginPage);
            document.getElementById('adminLogoutBtn').addEventListener('click', showLoginPage);
            
            // 绑定添加学生按钮
            document.getElementById('addStudentBtn').addEventListener('click', function() {
                document.getElementById('addStudentModal').style.display = 'flex';
            });
            
            // 绑定添加学生表单提交
            document.getElementById('addStudentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const studentData = {
                    id: document.getElementById('studentId').value,
                    name: document.getElementById('studentName').value,
                    gender: document.getElementById('studentGender').value,
                    class: document.getElementById('studentClass').value,
                    phone: document.getElementById('studentPhone').value || '',
                    parentName: document.getElementById('parentName').value || '',
                    parentPhone: document.getElementById('parentPhone').value || ''
                };
                
                if (addStudent(studentData)) {
                    alert('学生添加成功！');
                    document.getElementById('addStudentModal').style.display = 'none';
                    this.reset();
                }
            });
            
            // 绑定关闭添加学生模态框
            document.getElementById('closeAddStudentModal').addEventListener('click', function() {
                document.getElementById('addStudentModal').style.display = 'none';
                document.getElementById('addStudentForm').reset();
            });
            
            // 绑定文件上传区域
            document.getElementById('fileUploadArea').addEventListener('click', function() {
                document.getElementById('studentFileInput').click();
            });
            
            // 绑定文件选择
            document.getElementById('studentFileInput').addEventListener('change', function(e) {
                if (this.files.length > 0) {
                    // 模拟读取Excel文件
                    const mockData = simulateExcelImport();
                    
                    // 显示预览
                    const previewTableBody = document.getElementById('previewTableBody');
                    previewTableBody.innerHTML = mockData.map(student => `
                        <tr>
                            <td>${student.id}</td>
                            <td>${student.name}</td>
                            <td>${student.gender}</td>
                            <td>${student.class}</td>
                        </tr>
                    `).join('');
                    
                    document.getElementById('uploadPreview').style.display = 'block';
                }
            });
            
            // 绑定确认导入按钮
            document.getElementById('confirmImportBtn').addEventListener('click', function() {
                const mockData = simulateExcelImport();
                let importedCount = 0;
                let duplicateCount = 0;
                
                mockData.forEach(student => {
                    // 检查是否已存在
                    if (!appData.students.some(s => s.id === student.id)) {
                        student.createTime = new Date().toISOString().split('T')[0];
                        appData.students.push(student);
                        importedCount++;
                    } else {
                        duplicateCount++;
                    }
                });
                
                saveDataToLocalStorage();
                updateStudentsDisplay();
                updateClassStatus();
                updateClassStatusDisplay();
                
                // 重置上传预览
                document.getElementById('uploadPreview').style.display = 'none';
                document.getElementById('studentFileInput').value = '';
                
                alert(`导入完成！\n成功导入: ${importedCount} 名学生\n重复跳过: ${duplicateCount} 名学生`);
            });
            
            // 绑定取消导入按钮
            document.getElementById('cancelImportBtn').addEventListener('click', function() {
                document.getElementById('uploadPreview').style.display = 'none';
                document.getElementById('studentFileInput').value = '';
            });
            
            // 绑定下载模板按钮
            document.getElementById('downloadTemplateBtn').addEventListener('click', function() {
                alert('模板文件下载中...\n\n在实际系统中，这里会下载Excel模板文件。');
            });
            
            // 绑定保存教师设置按钮
            document.getElementById('saveTeacherSettingsBtn').addEventListener('click', function() {
                if (appData.currentTeacher) {
                    appData.currentTeacher.name = document.getElementById('teacherFullName').value;
                    appData.currentTeacher.class = document.getElementById('teacherClass').value;
                    appData.currentTeacher.subject = document.getElementById('teacherSubject').value;
                    appData.currentTeacher.email = document.getElementById('teacherEmail').value;
                    appData.currentTeacher.phone = document.getElementById('teacherPhone').value;
                    
                    // 更新密码
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    if (currentPassword || newPassword || confirmPassword) {
                        if (currentPassword !== appData.currentTeacher.password) {
                            alert('当前密码错误！');
                            return;
                        }
                        
                        if (newPassword !== confirmPassword) {
                            alert('新密码和确认密码不一致！');
                            return;
                        }
                        
                        if (newPassword.length < 6) {
                            alert('新密码长度不能少于6位！');
                            return;
                        }
                        
                        appData.currentTeacher.password = newPassword;
                        alert('密码修改成功！');
                        
                        // 清空密码字段
                        document.getElementById('currentPassword').value = '';
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmPassword').value = '';
                    }
                    
                    saveDataToLocalStorage();
                    updateTeacherInfoDisplay();
                    alert('个人信息保存成功！');
                }
            });
            
            // 绑定添加教师按钮
            document.getElementById('addTeacherBtn').addEventListener('click', function() {
                document.getElementById('addTeacherModal').style.display = 'flex';
            });
            
            // 绑定添加教师表单提交
            document.getElementById('addTeacherForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const password = document.getElementById('teacherPassword').value;
                const confirmPassword = document.getElementById('confirmTeacherPassword').value;
                
                if (password !== confirmPassword) {
                    alert('密码和确认密码不一致！');
                    return;
                }
                
                if (password.length < 6) {
                    alert('密码长度不能少于6位！');
                    return;
                }
                
                const teacherData = {
                    id: document.getElementById('teacherId').value,
                    username: document.getElementById('teacherUsername').value,
                    password: password,
                    name: document.getElementById('newTeacherName').value,
                    subject: document.getElementById('newTeacherSubject').value,
                    class: document.getElementById('newTeacherClass').value
                };
                
                if (addTeacher(teacherData)) {
                    alert('教师账户创建成功！');
                    document.getElementById('addTeacherModal').style.display = 'none';
                    this.reset();
                }
            });
            
            // 绑定关闭添加教师模态框
            document.getElementById('closeAddTeacherModal').addEventListener('click', function() {
                document.getElementById('addTeacherModal').style.display = 'none';
                document.getElementById('addTeacherForm').reset();
            });
            
            // 绑定更改密码表单提交
            document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const teacherId = document.getElementById('selectedTeacherId').value;
                const newPassword = document.getElementById('newTeacherPassword').value;
                const confirmPassword = document.getElementById('confirmNewTeacherPassword').value;
                
                if (newPassword !== confirmPassword) {
                    alert('新密码和确认密码不一致！');
                    return;
                }
                
                if (newPassword.length < 6) {
                    alert('密码长度不能少于6位！');
                    return;
                }
                
                const teacher = appData.teachers.find(t => t.id === teacherId);
                if (teacher) {
                    teacher.password = newPassword;
                    saveDataToLocalStorage();
                    alert('密码更改成功！');
                    document.getElementById('changePasswordModal').style.display = 'none';
                    this.reset();
                }
            });
            
            // 绑定关闭更改密码模态框
            document.getElementById('closeChangePasswordModal').addEventListener('click', function() {
                document.getElementById('changePasswordModal').style.display = 'none';
                document.getElementById('changePasswordForm').reset();
            });
            
            // 绑定系统设置相关按钮
            const focusThresholdSlider = document.getElementById('focusThreshold');
            if (focusThresholdSlider) {
                focusThresholdSlider.addEventListener('input', function() {
                    document.getElementById('focusThresholdValue').textContent = this.value + '%';
                    appData.systemSettings.focusThreshold = parseInt(this.value);
                });
            }
            
            document.getElementById('dataCollectionFrequency').addEventListener('change', function() {
                appData.systemSettings.dataCollectionFrequency = parseInt(this.value);
            });
            
            document.getElementById('lowFocusAlert').addEventListener('change', function() {
                appData.systemSettings.lowFocusAlert = this.checked;
            });
            
            document.getElementById('abnormalBehaviorAlert').addEventListener('change', function() {
                appData.systemSettings.abnormalBehaviorAlert = this.checked;
            });
            
            document.getElementById('dailyReportAlert').addEventListener('change', function() {
                appData.systemSettings.dailyReportAlert = this.checked;
            });
            
            document.getElementById('saveSystemSettingsBtn').addEventListener('click', function() {
                saveDataToLocalStorage();
                alert('系统设置保存成功！');
            });
            
            document.getElementById('exportAllDataBtn').addEventListener('click', function() {
                alert('数据导出中...\n\n在实际系统中，这里会导出所有系统数据为Excel文件。');
            });
            
            document.getElementById('clearHistoryDataBtn').addEventListener('click', function() {
                if (confirm('确定要清空所有历史数据吗？此操作不可撤销。')) {
                    appData.historyReports = [];
                    saveDataToLocalStorage();
                    alert('历史数据已清空！');
                }
            });
            
            document.getElementById('rebuildIndexBtn').addEventListener('click', function() {
                alert('数据库索引重建中...\n\n在实际系统中，这里会重建数据库索引以优化查询性能。');
            });
            
            // 绑定导出报告按钮
            document.getElementById('exportReportBtn').addEventListener('click', function() {
                alert('报告导出中...\n\n在实际系统中，这里会根据选择的时间段导出专注度报告。');
            });
            
            // 绑定班级筛选
            document.getElementById('classFilter').addEventListener('change', function() {
                updateClassStatusDisplay();
            });
            
            // 绑定学生搜索
            document.getElementById('studentSearch').addEventListener('input', function() {
                // 在实际系统中，这里会根据搜索关键词筛选学生
            });
            
            // 初始化所有密码显示/隐藏切换按钮
            document.querySelectorAll('.password-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('input');
                    const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                    input.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            });
            
            // 初始化模态框点击外部关闭
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                        // 重置表单
                        const form = this.querySelector('form');
                        if (form) form.reset();
                    }
                });
            });
        });
        
        // 显示登录页面
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('teacherPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'none';
            
            // 重置表单
            document.getElementById('loginForm').reset();
            document.getElementById('password').setAttribute('type', 'password');
            document.getElementById('togglePassword').innerHTML = '<i class="fas fa-eye"></i>';
        }
        
        // 显示教师端页面
        function showTeacherPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('teacherPage').style.display = 'flex';
            document.getElementById('adminPage').style.display = 'none';
            
            // 更新教师信息显示
            updateTeacherInfoDisplay();
            
            // 更新学生显示
            updateStudentsDisplay();
            
            // 默认显示仪表盘
            showTeacherPageContent('dashboard');
        }
        
        // 显示管理员端页面
        function showAdminPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('teacherPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'flex';
            
            // 更新班级状态数据
            updateClassStatus();
            updateClassStatusDisplay();
            
            // 更新全校统计数据
            updateSchoolStats();
            
            // 更新教师显示
            updateTeachersDisplay();
            
            // 默认显示班级监控
            showAdminPageContent('adminDashboard');
        }
        
        // 显示教师端内容页面
        function showTeacherPageContent(page) {
            // 隐藏所有内容页面
            document.querySelectorAll('#teacherPage .page-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // 显示选中的内容页面
            document.getElementById(page + 'Page').style.display = 'block';
            
            // 更新页面标题
            const pageTitles = {
                dashboard: '监控仪表盘',
                reports: '历史报告',
                students: '学生管理',
                import: '导入学生',
                settings: '个人设置'
            };
            document.getElementById('pageTitle').textContent = pageTitles[page];
            
            // 更新导航菜单激活状态
            document.querySelectorAll('#teacherPage .nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === page) {
                    item.classList.add('active');
                }
            });
        }
        
        // 显示管理员端内容页面
        function showAdminPageContent(page) {
            // 隐藏所有内容页面
            document.querySelectorAll('#adminPage .page-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // 显示选中的内容页面
            document.getElementById(page + 'Page').style.display = 'block';
            
            // 更新页面标题
            const pageTitles = {
                adminDashboard: '班级实时状态',
                teacherManagement: '教师管理',
                systemSettings: '系统设置'
            };
            document.getElementById('adminPageTitle').textContent = pageTitles[page];
            
            // 更新导航菜单激活状态
            document.querySelectorAll('#adminPage .nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === page) {
                    item.classList.add('active');
                }
            });
            
            // 如果是系统设置页面，加载当前设置
            if (page === 'systemSettings') {
                document.getElementById('focusThreshold').value = appData.systemSettings.focusThreshold;
                document.getElementById('focusThresholdValue').textContent = appData.systemSettings.focusThreshold + '%';
                document.getElementById('dataCollectionFrequency').value = appData.systemSettings.dataCollectionFrequency;
                document.getElementById('lowFocusAlert').checked = appData.systemSettings.lowFocusAlert;
                document.getElementById('abnormalBehaviorAlert').checked = appData.systemSettings.abnormalBehaviorAlert;
                document.getElementById('dailyReportAlert').checked = appData.systemSettings.dailyReportAlert;
            }
        }
        
        // 更新日期时间
        function updateDateTime() {
            const now = new Date();
            const dateStr = `${now.getFullYear()}年${now.getMonth()+1}月${now.getDate()}日`;
            const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            
            const currentDateTimeElement = document.getElementById('currentDateTime');
            const adminCurrentDateTimeElement = document.getElementById('adminCurrentDateTime');
            
            if (currentDateTimeElement) {
                currentDateTimeElement.textContent = `${dateStr} ${timeStr}`;
            }
            
            if (adminCurrentDateTimeElement) {
                adminCurrentDateTimeElement.textContent = `${dateStr} ${timeStr}`;
            }
        }
    </script>
</body>
</html>